import{useApi as e,defineInterface as t}from"@directus/extensions-sdk";import{defineComponent as a,inject as n,ref as l,computed as i,resolveComponent as o,openBlock as r,createElementBlock as d,createVNode as s,unref as c,withCtx as f,createTextVNode as u,toDisplayString as p,createBlock as v,createCommentVNode as m,Fragment as g}from"vue";import{useI18n as y}from"vue-i18n";const h={class:"pdf-to-html-interface"};var _=a({__name:"interface",props:{file_field:{},target_field:{},button_label:{default:"Convert PDF to HTML"}},setup(t){const a=t,{t:_}=y(),b=e(),T=n("values",l({})),x=l(!1),L=l(null),w=l(!1),{fileID:F,fileIsValid:D}=function(){const e=n("values",l({})),t=i((()=>{var t;return a.file_field&&null!=(t=e.value[a.file_field])?t:null})),o=i((()=>!!t.value));return{fileID:t,fileIsValid:o}}();async function H(){var e,t;if(F.value){x.value=!0,L.value=null,w.value=!1;try{const n=await b.get(`/llama-pdf-extract/${F.value}`);if(!(null==(t=null==(e=n.data)?void 0:e.data)?void 0:t.html))throw new Error("No HTML content received from conversion service");a.target_field&&T.value&&(T.value[a.target_field]=n.data.data.html);try{await navigator.clipboard.writeText(n.data.data.html),w.value=!0}catch(e){console.warn("Could not copy to clipboard:",e),w.value=!!a.target_field}}catch(e){console.error("Error converting PDF:",e),L.value=e.message||"Failed to convert PDF"}finally{x.value=!1,w.value&&setTimeout((()=>{w.value=!1}),3e3)}}}return(e,t)=>{const a=o("v-icon"),n=o("v-button"),l=o("v-notice");return r(),d("div",h,[s(n,{disabled:!c(D),loading:x.value,onClick:H},{default:f((()=>[s(a,{name:"transform",left:""}),u(" "+p(c(_)(e.button_label)),1)])),_:1},8,["disabled","loading"]),L.value?(r(),v(l,{key:0,type:"danger",class:"notice"},{default:f((()=>[u(p(L.value),1)])),_:1})):m("v-if",!0),w.value?(r(),v(l,{key:1,type:"success",class:"notice"},{default:f((()=>[e.target_field?(r(),d(g,{key:0},[u(" HTML content has been inserted into "+p(e.target_field)+" field ",1)],64)):(r(),d(g,{key:1},[u(" HTML content has been copied to clipboard ")],64))])),_:1})):m("v-if",!0)])}}}),b=[],T=[];!function(e,t){if(e&&"undefined"!=typeof document){var a,n=!0===t.prepend?"prepend":"append",l=!0===t.singleTag,i="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(l){var o=b.indexOf(i);-1===o&&(o=b.push(i)-1,T[o]={}),a=T[o]&&T[o][n]?T[o][n]:T[o][n]=r()}else a=r();65279===e.charCodeAt(0)&&(e=e.substring(1)),a.styleSheet?a.styleSheet.cssText+=e:a.appendChild(document.createTextNode(e))}function r(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var a=Object.keys(t.attributes),l=0;l<a.length;l++)e.setAttribute(a[l],t.attributes[a[l]]);var o="prepend"===n?"afterbegin":"beforeend";return i.insertAdjacentElement(o,e),e}}("\n.pdf-to-html-interface[data-v-600188d0] {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 8px;\n}\n.notice[data-v-600188d0] {\n\tmargin-top: 8px;\n}\n",{});var x=t({id:"pdf-to-html-interface",name:"PDF to HTML",icon:"transform",description:"Convert PDF files to formatted HTML",component:((e,t)=>{const a=e.__vccOpts||e;for(const[e,n]of t)a[e]=n;return a})(_,[["__scopeId","data-v-600188d0"],["__file","interface.vue"]]),types:["alias"],localTypes:["presentation"],group:"presentation",options:({collection:e})=>[{field:"file_field",type:"string",name:"PDF Field",meta:{width:"half",interface:"system-field",options:{collectionName:e,typeAllowList:["uuid"]}}},{field:"target_field",type:"string",name:"Target HTML Field",meta:{width:"half",interface:"system-field",options:{collectionName:e,typeAllowList:["text","string"]}}},{field:"button_label",name:"Button Label",type:"string",meta:{width:"half",interface:"input",options:{placeholder:"Convert PDF to HTML"}},schema:{default_value:"Convert PDF to HTML"}}]});export{x as default};
